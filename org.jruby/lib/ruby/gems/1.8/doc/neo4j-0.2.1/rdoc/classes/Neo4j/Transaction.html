<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Neo4j::Transaction</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Neo4j::Transaction</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/neo4j/transaction_rb.html">
                lib/neo4j/transaction.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Wraps a <a href="../Neo4j.html">Neo4j</a> java transaction and lucene
transactions. There can only be one transaction per thread.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000138">called</a>&nbsp;&nbsp;
      <a href="#M000142">current</a>&nbsp;&nbsp;
      <a href="#M000152">failure</a>&nbsp;&nbsp;
      <a href="#M000144">failure?</a>&nbsp;&nbsp;
      <a href="#M000147">failure?</a>&nbsp;&nbsp;
      <a href="#M000151">finish</a>&nbsp;&nbsp;
      <a href="#M000140">new</a>&nbsp;&nbsp;
      <a href="#M000145">new</a>&nbsp;&nbsp;
      <a href="#M000149">placebo</a>&nbsp;&nbsp;
      <a href="#M000139">placebo?</a>&nbsp;&nbsp;
      <a href="#M000148">placebo?</a>&nbsp;&nbsp;
      <a href="#M000141">run</a>&nbsp;&nbsp;
      <a href="#M000143">running?</a>&nbsp;&nbsp;
      <a href="#M000150">success</a>&nbsp;&nbsp;
      <a href="#M000146">to_s</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">neo_tx</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000138" class="method-detail">
        <a name="M000138"></a>

        <div class="method-heading">
          <a href="#M000138" class="method-signature">
          <span class="method-name">called</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
debugging method
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000138-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000138-source">
<pre>
    <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 36</span>
36:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">called</span>
37:         <span class="ruby-identifier">res</span> = <span class="ruby-value str">&quot;&quot;</span>
38:         <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">7</span> <span class="ruby-keyword kw">do</span>
39:           <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-regexp re">/\`([^\']+)\'/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">caller</span>(<span class="ruby-identifier">i</span>).<span class="ruby-identifier">first</span>)[<span class="ruby-value">1</span>]
40:           <span class="ruby-identifier">res</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">', '</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-value">4</span>
41:         <span class="ruby-keyword kw">end</span>
42:         <span class="ruby-identifier">res</span>
43:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000142" class="method-detail">
        <a name="M000142"></a>

        <div class="method-heading">
          <a href="#M000142" class="method-signature">
          <span class="method-name">current</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000142-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000142-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 117</span>
117:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current</span>
118:         <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:transaction</span>]
119:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000144" class="method-detail">
        <a name="M000144"></a>

        <div class="method-heading">
          <a href="#M000144" class="method-signature">
          <span class="method-name">failure?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000144-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000144-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 125</span>
125:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">failure?</span>
126:         <span class="ruby-identifier">current</span>.<span class="ruby-identifier">failure?</span>
127:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000140" class="method-detail">
        <a name="M000140"></a>

        <div class="method-heading">
          <a href="#M000140" class="method-signature">
          <span class="method-name">new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a transaction. If one is already running then a &#8216;<a
href="Transaction.html#M000149">placebo</a>&#8217; transaction will be
created instead. A <a href="Transaction.html#M000149">placebo</a>
transactions wraps the real transaction by not allowing the <a
href="Transaction.html#M000151">finish</a> method to <a
href="Transaction.html#M000151">finish</a> the real transaction.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000140-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000140-source">
<pre>
    <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 53</span>
53:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new</span>
54:         <span class="ruby-identifier">neo_tx</span>= <span class="ruby-constant">Neo4j</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">begin_transaction</span>
55:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">placebo?</span>(<span class="ruby-identifier">neo_tx</span>)
56:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">StandardError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Neo4j created a placebo transaction but an real transaction did not exist yet&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
57:           <span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">placebo</span>
58:         <span class="ruby-keyword kw">else</span>
59:           <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">neo_tx</span>)
60:         <span class="ruby-keyword kw">end</span>
61:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000145" class="method-detail">
        <a name="M000145"></a>

        <div class="method-heading">
          <a href="#M000145" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(neo_tx)</span>
          </a>
        </div>
      
        <div class="method-description">
          <hr size="10"></hr><p>
Instance methods
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000145-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000145-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 137</span>
137:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">neo_tx</span>)
138:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">AlreadyInTransactionError</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
139:       <span class="ruby-ivar">@neo_tx</span> = <span class="ruby-identifier">neo_tx</span>
140:       <span class="ruby-ivar">@@counter</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
141:       <span class="ruby-ivar">@id</span> = <span class="ruby-ivar">@@counter</span>
142:       <span class="ruby-ivar">@failure</span> = <span class="ruby-keyword kw">false</span>      
143:       <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:transaction</span>] = <span class="ruby-keyword kw">self</span>
144:       <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">debug</span>{<span class="ruby-node">&quot;create #{self.to_s}&quot;</span>}
145:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000139" class="method-detail">
        <a name="M000139"></a>

        <div class="method-heading">
          <a href="#M000139" class="method-signature">
          <span class="method-name">placebo?</span><span class="method-args">(tx)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000139-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000139-source">
<pre>
    <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 45</span>
45:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">placebo?</span>(<span class="ruby-identifier">tx</span>)
46:         <span class="ruby-constant">Neo4j</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">placebo_tx</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">tx</span>
47:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000141" class="method-detail">
        <a name="M000141"></a>

        <div class="method-heading">
          <a href="#M000141" class="method-signature">
          <span class="method-name">run</span><span class="method-args">() {|tx| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Runs a block in a <a href="../Neo4j.html">Neo4j</a> transaction
</p>
<p>
Most operations on neo requires an transaction. In <a
href="../Neo4j.html">Neo4j</a> all read and write operations are wrapped
automatically in an transaction. You will get much better performance if
one transaction is wrapped around several neo operation instead of running
one transaction per neo operation. If one transaction is already running
then a &#8216;<a href="Transaction.html#M000149">placebo</a>&#8217;
transaction will be created. Performing a <a
href="Transaction.html#M000151">finish</a> on a <a
href="Transaction.html#M000149">placebo</a> transaction will not <a
href="Transaction.html#M000151">finish</a> the &#8216;real&#8217;
transaction.
</p>
<h4>Params</h4>
<p>
@yield the block to be performed in one transaction @yieldparam [<a
href="Transaction.html">Neo4j::Transaction</a>] The transaction
</p>
<h4>Examples</h4>
<pre>
 include 'neo4j'

 Neo4j::Transaction.run {
   node = PersonNode.new
 }
</pre>
<p>
You have also access to transaction object
</p>
<pre>
  Neo4j::Transaction.run { |t|
    # something failed
    t.failure # will cause a rollback
  }
</pre>
<h4>Returns</h4>
<p>
The value of the evaluated provided block
</p>
<p>
:api: public
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000141-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000141-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 96</span>
 96:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>
 97:         <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">info</span>{<span class="ruby-value str">&quot;new transaction &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">called</span>}
 98:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;Expected a block to run in Transaction.run&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block_given?</span>
 99: 
100:         <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">nil</span>
101:     
102:         <span class="ruby-keyword kw">begin</span>
103:           <span class="ruby-identifier">tx</span> = <span class="ruby-constant">Neo4j</span><span class="ruby-operator">::</span><span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">new</span>
104:           <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">tx</span>
105:           <span class="ruby-identifier">tx</span>.<span class="ruby-identifier">success</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">tx</span>.<span class="ruby-identifier">failure?</span>
106:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>  
107:           <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">warn</span>{<span class="ruby-node">&quot;Neo transaction rolled back because of an exception, #{e}&quot;</span>}
108:           <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">warn</span>{<span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)}
109:           <span class="ruby-identifier">tx</span>.<span class="ruby-identifier">failure</span>
110:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>  
111:         <span class="ruby-keyword kw">ensure</span>  
112:           <span class="ruby-identifier">tx</span>.<span class="ruby-identifier">finish</span>  
113:         <span class="ruby-keyword kw">end</span>      
114:         <span class="ruby-identifier">ret</span>
115:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000143" class="method-detail">
        <a name="M000143"></a>

        <div class="method-heading">
          <a href="#M000143" class="method-signature">
          <span class="method-name">running?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000143-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000143-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 121</span>
121:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">running?</span>
122:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">neo_tx</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
123:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="#M000152" class="method-signature">
          <span class="method-name">failure</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Marks this transaction as failed, which means that it will inexplicably be
rolled back upon invocation of <a
href="Transaction.html#M000151">finish</a>().
</p>
<p>
:api: public
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000152-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000152-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 204</span>
204:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">failure</span>
205:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotInTransactionError</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
206:       <span class="ruby-ivar">@neo_tx</span>.<span class="ruby-identifier">failure</span>
207:       <span class="ruby-ivar">@failure</span> = <span class="ruby-keyword kw">true</span>
208:       <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">info</span>{<span class="ruby-node">&quot;failure #{self.to_s}&quot;</span>}                        
209:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000147" class="method-detail">
        <a name="M000147"></a>

        <div class="method-heading">
          <a href="#M000147" class="method-signature">
          <span class="method-name">failure?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000147-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000147-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 152</span>
152:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">failure?</span>
153:       <span class="ruby-ivar">@failure</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>
154:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="#M000151" class="method-signature">
          <span class="method-name">finish</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Commits or marks this transaction for rollback, depending on whether <a
href="Transaction.html#M000150">success</a>() or <a
href="Transaction.html#M000152">failure</a>() has been previously invoked.
</p>
<p>
:api: public
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000151-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000151-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 180</span>
180:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">finish</span>
181:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotInTransactionError</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
182:       <span class="ruby-ivar">@neo_tx</span>.<span class="ruby-identifier">finish</span>
183:       <span class="ruby-ivar">@neo_tx</span>=<span class="ruby-keyword kw">nil</span>
184:       <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>[<span class="ruby-identifier">:transaction</span>] = <span class="ruby-keyword kw">nil</span>
185:       
186:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Lucene</span><span class="ruby-operator">::</span><span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
187:         <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">debug</span>{<span class="ruby-node">&quot;LUCENE TX running failure: #{failure?}&quot;</span>}
188:         
189:         <span class="ruby-comment cmt"># mark lucene transaction for failure if the neo transaction fails</span>
190:         <span class="ruby-constant">Lucene</span><span class="ruby-operator">::</span><span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">failure</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">failure?</span>
191:         <span class="ruby-constant">Lucene</span><span class="ruby-operator">::</span><span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">commit</span> 
192:       <span class="ruby-keyword kw">else</span>
193:         <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">debug</span>{<span class="ruby-value str">&quot;NO LUCENE TX running&quot;</span>}
194:       <span class="ruby-keyword kw">end</span>
195:           
196:       
197:       <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">info</span>{<span class="ruby-node">&quot;finished #{self.to_s}&quot;</span>}                  
198:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">
          <a href="#M000149" class="method-signature">
          <span class="method-name">placebo</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000149-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000149-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 160</span>
160:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">placebo</span>
161:       <span class="ruby-ivar">@placebo</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">PlaceboTransaction</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>)
162:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000148" class="method-detail">
        <a name="M000148"></a>

        <div class="method-heading">
          <a href="#M000148" class="method-signature">
          <span class="method-name">placebo?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000148-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000148-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 156</span>
156:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">placebo?</span>
157:       <span class="ruby-ivar">@neo_tx</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Neo4j</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">placebo_tx</span>
158:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="#M000150" class="method-signature">
          <span class="method-name">success</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Marks this transaction as successful, which means that it will be commited
upon invocation of <a href="Transaction.html#M000151">finish</a>() unless
<a href="Transaction.html#M000152">failure</a>() has or will be invoked
before then.
</p>
<p>
:api: public
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000150-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000150-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 169</span>
169:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">success</span>
170:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotInTransactionError</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Transaction</span>.<span class="ruby-identifier">running?</span>
171:       <span class="ruby-identifier">$NEO_LOGGER</span>.<span class="ruby-identifier">info</span>{<span class="ruby-node">&quot;success #{self.to_s}&quot;</span>}      
172:       <span class="ruby-ivar">@neo_tx</span>.<span class="ruby-identifier">success</span>
173:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000146" class="method-detail">
        <a name="M000146"></a>

        <div class="method-heading">
          <a href="#M000146" class="method-signature">
          <span class="method-name">to_s</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000146-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000146-source">
<pre>
     <span class="ruby-comment cmt"># File lib/neo4j/transaction.rb, line 147</span>
147:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
148:       <span class="ruby-node">&quot;Transaction: placebo: #{placebo?}, #{@id} failure: #{failure?}, running #{Transaction.running?}, thread: #{Thread.current.to_s} #{@neo_tx}&quot;</span>
149:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>